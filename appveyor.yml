version: '{build}'
image: Visual Studio 2017

platform:
- x64
environment:
  matrix:
  - CONDA: 36-x64

init:
- call "C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\VC\Auxiliary\Build\vcvars64.bat"
- ps: Start-FileDownload 'http://repo.continuum.io/miniconda/Miniconda3-latest-Windows-x86_64.exe' C:\Miniconda.exe;
- cmd: C:\Miniconda.exe /S /D=C:\ecell4-base-conda
- "set PATH=C:\\ecell4-base-conda;C:\\ecell4-base-conda\\Scripts;C:\\ecell4-base-conda\\Library\\bin;%PATH%"

install:
- ps: |
    git submodule update -q --init --recursive
    conda config --set always_yes yes --set changeps1 no
    conda config --add channels conda-forge
    conda update -q conda
    conda install -q conda-build

build_script:
- ps: |
    conda build conda.recipe
    conda install --use-local ecell4-base

branches:
  only:
    - master
    - v4.2
    - conda-appveyor

# artifacts:
#   # bdist_wheel puts your built wheel in the dist directory
#   - path: python/dist/*

notifications:
  - provider: Slack
    auth_token:
      secure: xoxp-2152083718-2152083720-57117007011-a566bc1aa4
    channel: '#github'



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>World and Simulator with ODE solver &mdash; Test test documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Test test documentation" href="index.html"/>
        <link rel="next" title="Meso" href="Meso.html"/>
        <link rel="prev" title="Introduction" href="Introduction.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Test
          

          
          </a>

          
            
            
              <div class="version">
                test
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#running-e-cell4">Running E-Cell4</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#dockerized-e-cell4-jupyter-notebooks">Dockerized E-Cell4 Jupyter notebooks</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Attractors.html">Attractors</a></li>
<li class="toctree-l1"><a class="reference internal" href="DrosophilaCircadianClock.html">Drosophila Circadian Clock</a></li>
<li class="toctree-l1"><a class="reference internal" href="dpc.html">Dual Phosphorylation Cycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="HumanErythrocytes.html">A Simple Model of the Glycolysis of Human Erythrocytes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorial1.html">1. Brief Tour of E-Cell4 Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial2.html">2. How to Build a Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial3.html">3. How to Setup the Initial Condition</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial4.html">4. How to Run a Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial6.html">6. How to Solve ODEs with Rate Law Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial7.html">7. Introduction of Rule-based Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial8.html">8. More about 1. Brief Tour of E-Cell4 Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial9.html">9. Spatial Gillespie Method</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">World and Simulator with ODE solver</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creating-ode-world">Creating ODE world</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-use-real3">How to use Real3</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-and-running-odesimulator">Creating and Running ODESimulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#switching-the-solver">Switching the solver</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Meso.html">Meso</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spatiocyte.html">Spatiocyte simulations with single-molecule resolution</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Test</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>World and Simulator with ODE solver</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/WorldSimBasics.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="world-and-simulator-with-ode-solver">
<span id="world-and-simulator-with-ode-solver"></span><h1>World and Simulator with ODE solver<a class="headerlink" href="#world-and-simulator-with-ode-solver" title="Permalink to this headline">¶</a></h1>
<p>If you read through <a class="reference external" href="http://nbviewer.ipython.org/github/ecell/ecell4/blob/master/ipynb/Tutorials/Introduction.ipynb">Introduction</a>, it is NOT difficult to use <strong>World</strong> and <strong>Simulator</strong>.
<strong>volume</strong> and <strong>{&#8216;C&#8217;:60}</strong> is equivalent of the <strong>World</strong> and <strong>solver</strong> is the <strong>Simulator</strong> below.</p>
<pre class="code highlight python literal-block">
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">ecell4</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">with</span> <span class="n">reaction_rules</span><span class="p">():</span>
    <span class="n">A</span> <span class="o">+</span> <span class="n">B</span> <span class="o">==</span> <span class="n">C</span> <span class="o">|</span> <span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">run_simulation</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">{</span><span class="s">'C'</span><span class="p">:</span> <span class="mi">60</span><span class="p">},</span> <span class="n">volume</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre>
<p><img alt="png" src="worldsim_1_0.png" /></p>
<p>Here we give you a breakdown for <strong>run_simulation</strong>.
<strong>run_simulation</strong> use ODE simulator by default, so we create ODE world step by step.</p>
<div class="section" id="creating-ode-world">
<span id="creating-ode-world"></span><h2>Creating ODE world<a class="headerlink" href="#creating-ode-world" title="Permalink to this headline">¶</a></h2>
<p>You can create world like this.</p>
<pre class="code highlight python literal-block">
<span class="n">w</span> <span class="o">=</span> <span class="n">ode</span><span class="o">.</span><span class="n">ODEWorld</span><span class="p">(</span><span class="n">Real3</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre>
<p><strong>Real3</strong> is a coordinate vector.
In this example, the first argument for ODEWorld constructor is a cube.
Note that you can NOT use volume for ode.ODEWorld argument, like <strong>run_simulation</strong> argument.</p>
<p>Now you created a cube box for simulation, next let&#8217;s throw molecules into the cube.</p>
<pre class="code highlight python literal-block">
<span class="n">w</span> <span class="o">=</span> <span class="n">ode</span><span class="o">.</span><span class="n">ODEWorld</span><span class="p">(</span><span class="n">Real3</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">w</span><span class="o">.</span><span class="n">add_molecules</span><span class="p">(</span><span class="n">Species</span><span class="p">(</span><span class="s">'C'</span><span class="p">),</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">t</span><span class="p">(),</span> <span class="n">w</span><span class="o">.</span><span class="n">num_molecules</span><span class="p">(</span><span class="n">Species</span><span class="p">(</span><span class="s">'C'</span><span class="p">)))</span>  <span class="c"># will return (0.0, 60)</span>
</pre>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
</pre></div>
</div>
<p>Use <strong>add_molecules</strong> to add molecules, <strong>remove_molecules</strong> to remove molecules, <strong>num_molecules</strong> to know the number of molecules.
First argument for each method is the <strong>Species</strong> you want to know.
You can get current time by <strong>t</strong> method.
However the number of molecules in ODE solver is real number, in these **_molecules** functions work only for integer number.
If you use real number in ODE, use <strong>set_value</strong> and <strong>get_value</strong>.</p>
</div>
<div class="section" id="how-to-use-real3">
<span id="how-to-use-real3"></span><h2>How to use Real3<a class="headerlink" href="#how-to-use-real3" title="Permalink to this headline">¶</a></h2>
<p>Before the detail of <strong>Simulator</strong>, we explaing more about <strong>Real3</strong>.</p>
<pre class="code highlight python literal-block">
<span class="n">pos</span> <span class="o">=</span> <span class="n">Real3</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>  <span class="c"># will print &lt;ecell4.core.Real3 object at 0x7f44e118b9c0&gt;</span>
<span class="k">print</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span>  <span class="c"># will print (1.0, 2.0, 3.0)</span>
</pre>
<div class="highlight-python"><div class="highlight"><pre>&lt;ecell4.core.Real3 object at 0x7fc73ff9a948&gt;
(1.0, 2.0, 3.0)
</pre></div>
</div>
<p>You can not print <strong>Real3</strong> object directly.
You need to convert <strong>Real3</strong> to Python tuple or list once.</p>
<pre class="code highlight python literal-block">
<span class="n">pos1</span> <span class="o">=</span> <span class="n">Real3</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">pos2</span> <span class="o">=</span> <span class="n">pos1</span> <span class="o">+</span> <span class="n">pos1</span>
<span class="n">pos3</span> <span class="o">=</span> <span class="n">pos1</span> <span class="o">*</span> <span class="mi">3</span>
<span class="n">pos4</span> <span class="o">=</span> <span class="n">pos1</span> <span class="o">/</span> <span class="mi">5</span>
<span class="k">print</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">pos1</span><span class="p">))</span>  <span class="c"># will print 1.73205080757</span>
<span class="k">print</span><span class="p">(</span><span class="n">dot_product</span><span class="p">(</span><span class="n">pos1</span><span class="p">,</span> <span class="n">pos3</span><span class="p">))</span>  <span class="c"># will print 9.0</span>
</pre>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">1.73205080757</span>
<span class="mf">9.0</span>
</pre></div>
</div>
<p>You can use basic function like dot_product.
Of course you can convert Real3 to numpy array too.</p>
<pre class="code highlight python literal-block">
<span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">Real3</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c"># will print [ 1.  2.  3.]</span>
</pre>
<div class="highlight-python"><div class="highlight"><pre>[ 1.  2.  3.]
</pre></div>
</div>
</div>
<div class="section" id="creating-and-running-odesimulator">
<span id="creating-and-running-odesimulator"></span><h2>Creating and Running ODESimulator<a class="headerlink" href="#creating-and-running-odesimulator" title="Permalink to this headline">¶</a></h2>
<p>You can create a Simulator with Model and World like</p>
<pre class="code highlight python literal-block">
<span class="k">with</span> <span class="n">reaction_rules</span><span class="p">():</span>
    <span class="n">A</span> <span class="o">+</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">C</span> <span class="o">|</span> <span class="mf">0.01</span>  <span class="c"># equivalent to create_binding_reaction_rule</span>
    <span class="n">C</span> <span class="o">&gt;</span> <span class="n">A</span> <span class="o">+</span> <span class="n">B</span> <span class="o">|</span> <span class="mf">0.3</span>   <span class="c"># equivalent to create_unbinding_reaction_rule</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">get_model</span><span class="p">()</span>

<span class="n">sim</span> <span class="o">=</span> <span class="n">ode</span><span class="o">.</span><span class="n">ODESimulator</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
</pre>
<p>then call <strong>run</strong> method, the simulation will run.
In this example the simulation runs for 10seconds.</p>
<p>You can check the state of the <strong>World</strong> like this.</p>
<pre class="code highlight python literal-block">
<span class="k">print</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">t</span><span class="p">(),</span> <span class="n">w</span><span class="o">.</span><span class="n">num_molecules</span><span class="p">(</span><span class="n">Species</span><span class="p">(</span><span class="s">'C'</span><span class="p">)))</span>  <span class="c"># will return (10.0, 30)</span>
</pre>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p>You can see that the number of the <strong>Species</strong> <strong>C</strong> decreases from 60 to 30.</p>
<p><strong>World</strong> describes the state of a timepoint, so you can NOT see the transition of the simulation with the <strong>World</strong>.
To obtain the time-series result, use <strong>Observer</strong>.</p>
<pre class="code highlight python literal-block">
<span class="n">obs</span> <span class="o">=</span> <span class="n">FixedIntervalNumberObserver</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="s">'A'</span><span class="p">,</span> <span class="s">'C'</span><span class="p">))</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">obs</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">data</span><span class="p">())</span>  <span class="c"># will return [[0.0, 0.0, 60.0], ..., [10.0, 29.994446899698026, 30.005553100301967]]</span>
</pre>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">29.994445225953793</span><span class="p">,</span> <span class="mf">30.005554774046203</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.1</span><span class="p">,</span> <span class="mf">29.994923291781845</span><span class="p">,</span> <span class="mf">30.00507670821815</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.2</span><span class="p">,</span> <span class="mf">29.995360215494838</span><span class="p">,</span> <span class="mf">30.00463978450516</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.3</span><span class="p">,</span> <span class="mf">29.99575953741398</span><span class="p">,</span> <span class="mf">30.004240462586015</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.4</span><span class="p">,</span> <span class="mf">29.996124493269757</span><span class="p">,</span> <span class="mf">30.00387550673024</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.5</span><span class="p">,</span> <span class="mf">29.996458040397858</span><span class="p">,</span> <span class="mf">30.00354195960214</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.6</span><span class="p">,</span> <span class="mf">29.99676288168368</span><span class="p">,</span> <span class="mf">30.003237118316317</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.7</span><span class="p">,</span> <span class="mf">29.99704148744875</span><span class="p">,</span> <span class="mf">30.002958512551245</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.8</span><span class="p">,</span> <span class="mf">29.99729611545562</span><span class="p">,</span> <span class="mf">30.002703884544378</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.9</span><span class="p">,</span> <span class="mf">29.997528829192905</span><span class="p">,</span> <span class="mf">30.00247117080709</span><span class="p">],</span> <span class="p">[</span><span class="mf">11.0</span><span class="p">,</span> <span class="mf">29.997741514588153</span><span class="p">,</span> <span class="mf">30.002258485411843</span><span class="p">],</span> <span class="p">[</span><span class="mf">11.1</span><span class="p">,</span> <span class="mf">29.997935895283558</span><span class="p">,</span> <span class="mf">30.00206410471644</span><span class="p">],</span> <span class="p">[</span><span class="mf">11.2</span><span class="p">,</span> <span class="mf">29.99811354659805</span><span class="p">,</span> <span class="mf">30.001886453401948</span><span class="p">],</span> <span class="p">[</span><span class="mf">11.3</span><span class="p">,</span> <span class="mf">29.998275908288566</span><span class="p">,</span> <span class="mf">30.00172409171143</span><span class="p">],</span> <span class="p">[</span><span class="mf">11.4</span><span class="p">,</span> <span class="mf">29.99842429621383</span><span class="p">,</span> <span class="mf">30.001575703786166</span><span class="p">],</span> <span class="p">[</span><span class="mf">11.5</span><span class="p">,</span> <span class="mf">29.998559912994793</span><span class="p">,</span> <span class="mf">30.001440087005204</span><span class="p">],</span> <span class="p">[</span><span class="mf">11.6</span><span class="p">,</span> <span class="mf">29.998683857758166</span><span class="p">,</span> <span class="mf">30.00131614224183</span><span class="p">],</span> <span class="p">[</span><span class="mf">11.7</span><span class="p">,</span> <span class="mf">29.99879713504173</span><span class="p">,</span> <span class="mf">30.001202864958266</span><span class="p">],</span> <span class="p">[</span><span class="mf">11.8</span><span class="p">,</span> <span class="mf">29.99890066293361</span><span class="p">,</span> <span class="mf">30.001099337066385</span><span class="p">],</span> <span class="p">[</span><span class="mf">11.9</span><span class="p">,</span> <span class="mf">29.998995280511267</span><span class="p">,</span> <span class="mf">30.00100471948873</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.0</span><span class="p">,</span> <span class="mf">29.999081754640535</span><span class="p">,</span> <span class="mf">30.00091824535946</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.1</span><span class="p">,</span> <span class="mf">29.999160786189673</span><span class="p">,</span> <span class="mf">30.000839213810323</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.2</span><span class="p">,</span> <span class="mf">29.999233015708754</span><span class="p">,</span> <span class="mf">30.000766984291243</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.3</span><span class="p">,</span> <span class="mf">29.999299028620428</span><span class="p">,</span> <span class="mf">30.00070097137957</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.4</span><span class="p">,</span> <span class="mf">29.999359359963993</span><span class="p">,</span> <span class="mf">30.000640640036004</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.5</span><span class="p">,</span> <span class="mf">29.999414498731316</span><span class="p">,</span> <span class="mf">30.00058550126868</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.6</span><span class="p">,</span> <span class="mf">29.999464891829593</span><span class="p">,</span> <span class="mf">30.000535108170403</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.7</span><span class="p">,</span> <span class="mf">29.999510947703186</span><span class="p">,</span> <span class="mf">30.00048905229681</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.8</span><span class="p">,</span> <span class="mf">29.99955303964374</span><span class="p">,</span> <span class="mf">30.000446960356257</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.9</span><span class="p">,</span> <span class="mf">29.999591508815463</span><span class="p">,</span> <span class="mf">30.000408491184533</span><span class="p">],</span> <span class="p">[</span><span class="mf">13.0</span><span class="p">,</span> <span class="mf">29.999626667020085</span><span class="p">,</span> <span class="mf">30.000373332979912</span><span class="p">],</span> <span class="p">[</span><span class="mf">13.1</span><span class="p">,</span> <span class="mf">29.999658799223873</span><span class="p">,</span> <span class="mf">30.000341200776123</span><span class="p">],</span> <span class="p">[</span><span class="mf">13.2</span><span class="p">,</span> <span class="mf">29.99968816586716</span><span class="p">,</span> <span class="mf">30.000311834132837</span><span class="p">],</span> <span class="p">[</span><span class="mf">13.3</span><span class="p">,</span> <span class="mf">29.999715004975137</span><span class="p">,</span> <span class="mf">30.00028499502486</span><span class="p">],</span> <span class="p">[</span><span class="mf">13.4</span><span class="p">,</span> <span class="mf">29.999739534087013</span><span class="p">,</span> <span class="mf">30.000260465912984</span><span class="p">],</span> <span class="p">[</span><span class="mf">13.5</span><span class="p">,</span> <span class="mf">29.999761952019092</span><span class="p">,</span> <span class="mf">30.000238047980904</span><span class="p">],</span> <span class="p">[</span><span class="mf">13.6</span><span class="p">,</span> <span class="mf">29.999782440476185</span><span class="p">,</span> <span class="mf">30.00021755952381</span><span class="p">],</span> <span class="p">[</span><span class="mf">13.7</span><span class="p">,</span> <span class="mf">29.9998011655243</span><span class="p">,</span> <span class="mf">30.000198834475697</span><span class="p">],</span> <span class="p">[</span><span class="mf">13.8</span><span class="p">,</span> <span class="mf">29.99981827893661</span><span class="p">,</span> <span class="mf">30.000181721063388</span><span class="p">],</span> <span class="p">[</span><span class="mf">13.9</span><span class="p">,</span> <span class="mf">29.999833919423562</span><span class="p">,</span> <span class="mf">30.000166080576435</span><span class="p">],</span> <span class="p">[</span><span class="mf">14.0</span><span class="p">,</span> <span class="mf">29.99984821375716</span><span class="p">,</span> <span class="mf">30.000151786242835</span><span class="p">],</span> <span class="p">[</span><span class="mf">14.100000000000001</span><span class="p">,</span> <span class="mf">29.99986127779844</span><span class="p">,</span> <span class="mf">30.000138722201555</span><span class="p">],</span> <span class="p">[</span><span class="mf">14.2</span><span class="p">,</span> <span class="mf">29.99987321743654</span><span class="p">,</span> <span class="mf">30.000126782563456</span><span class="p">],</span> <span class="p">[</span><span class="mf">14.3</span><span class="p">,</span> <span class="mf">29.99988412944696</span><span class="p">,</span> <span class="mf">30.000115870553035</span><span class="p">],</span> <span class="p">[</span><span class="mf">14.4</span><span class="p">,</span> <span class="mf">29.999894102275928</span><span class="p">,</span> <span class="mf">30.00010589772407</span><span class="p">],</span> <span class="p">[</span><span class="mf">14.5</span><span class="p">,</span> <span class="mf">29.999903216757303</span><span class="p">,</span> <span class="mf">30.000096783242693</span><span class="p">],</span> <span class="p">[</span><span class="mf">14.600000000000001</span><span class="p">,</span> <span class="mf">29.999911546767716</span><span class="p">,</span> <span class="mf">30.00008845323228</span><span class="p">],</span> <span class="p">[</span><span class="mf">14.7</span><span class="p">,</span> <span class="mf">29.999919159825385</span><span class="p">,</span> <span class="mf">30.00008084017461</span><span class="p">],</span> <span class="p">[</span><span class="mf">14.8</span><span class="p">,</span> <span class="mf">29.99992611763737</span><span class="p">,</span> <span class="mf">30.000073882362628</span><span class="p">],</span> <span class="p">[</span><span class="mf">14.9</span><span class="p">,</span> <span class="mf">29.99993247659969</span><span class="p">,</span> <span class="mf">30.000067523400308</span><span class="p">],</span> <span class="p">[</span><span class="mf">15.0</span><span class="p">,</span> <span class="mf">29.99993828825447</span><span class="p">,</span> <span class="mf">30.000061711745527</span><span class="p">],</span> <span class="p">[</span><span class="mf">15.100000000000001</span><span class="p">,</span> <span class="mf">29.999943599707688</span><span class="p">,</span> <span class="mf">30.00005640029231</span><span class="p">],</span> <span class="p">[</span><span class="mf">15.2</span><span class="p">,</span> <span class="mf">29.999948454010994</span><span class="p">,</span> <span class="mf">30.000051545989002</span><span class="p">],</span> <span class="p">[</span><span class="mf">15.3</span><span class="p">,</span> <span class="mf">29.999952890510645</span><span class="p">,</span> <span class="mf">30.00004710948935</span><span class="p">],</span> <span class="p">[</span><span class="mf">15.4</span><span class="p">,</span> <span class="mf">29.99995694516643</span><span class="p">,</span> <span class="mf">30.000043054833565</span><span class="p">],</span> <span class="p">[</span><span class="mf">15.5</span><span class="p">,</span> <span class="mf">29.999960650843132</span><span class="p">,</span> <span class="mf">30.000039349156864</span><span class="p">],</span> <span class="p">[</span><span class="mf">15.600000000000001</span><span class="p">,</span> <span class="mf">29.999964037576916</span><span class="p">,</span> <span class="mf">30.00003596242308</span><span class="p">],</span> <span class="p">[</span><span class="mf">15.7</span><span class="p">,</span> <span class="mf">29.999967132818774</span><span class="p">,</span> <span class="mf">30.000032867181222</span><span class="p">],</span> <span class="p">[</span><span class="mf">15.8</span><span class="p">,</span> <span class="mf">29.999969961657037</span><span class="p">,</span> <span class="mf">30.00003003834296</span><span class="p">],</span> <span class="p">[</span><span class="mf">15.9</span><span class="p">,</span> <span class="mf">29.999972547020704</span><span class="p">,</span> <span class="mf">30.000027452979293</span><span class="p">],</span> <span class="p">[</span><span class="mf">16.0</span><span class="p">,</span> <span class="mf">29.999974909865326</span><span class="p">,</span> <span class="mf">30.00002509013467</span><span class="p">],</span> <span class="p">[</span><span class="mf">16.1</span><span class="p">,</span> <span class="mf">29.999977069342826</span><span class="p">,</span> <span class="mf">30.00002293065717</span><span class="p">],</span> <span class="p">[</span><span class="mf">16.2</span><span class="p">,</span> <span class="mf">29.99997904295676</span><span class="p">,</span> <span class="mf">30.000020957043237</span><span class="p">],</span> <span class="p">[</span><span class="mf">16.3</span><span class="p">,</span> <span class="mf">29.99998084670416</span><span class="p">,</span> <span class="mf">30.000019153295835</span><span class="p">],</span> <span class="p">[</span><span class="mf">16.4</span><span class="p">,</span> <span class="mf">29.999982495205234</span><span class="p">,</span> <span class="mf">30.000017504794762</span><span class="p">],</span> <span class="p">[</span><span class="mf">16.5</span><span class="p">,</span> <span class="mf">29.999984001821836</span><span class="p">,</span> <span class="mf">30.00001599817816</span><span class="p">],</span> <span class="p">[</span><span class="mf">16.6</span><span class="p">,</span> <span class="mf">29.999985378765786</span><span class="p">,</span> <span class="mf">30.00001462123421</span><span class="p">],</span> <span class="p">[</span><span class="mf">16.7</span><span class="p">,</span> <span class="mf">29.99998663719784</span><span class="p">,</span> <span class="mf">30.000013362802157</span><span class="p">],</span> <span class="p">[</span><span class="mf">16.8</span><span class="p">,</span> <span class="mf">29.999987787318176</span><span class="p">,</span> <span class="mf">30.00001221268182</span><span class="p">],</span> <span class="p">[</span><span class="mf">16.9</span><span class="p">,</span> <span class="mf">29.99998883844905</span><span class="p">,</span> <span class="mf">30.000011161550947</span><span class="p">],</span> <span class="p">[</span><span class="mf">17.0</span><span class="p">,</span> <span class="mf">29.99998979911036</span><span class="p">,</span> <span class="mf">30.000010200889637</span><span class="p">],</span> <span class="p">[</span><span class="mf">17.1</span><span class="p">,</span> <span class="mf">29.999990677088707</span><span class="p">,</span> <span class="mf">30.00000932291129</span><span class="p">],</span> <span class="p">[</span><span class="mf">17.2</span><span class="p">,</span> <span class="mf">29.999991479500515</span><span class="p">,</span> <span class="mf">30.00000852049948</span><span class="p">],</span> <span class="p">[</span><span class="mf">17.3</span><span class="p">,</span> <span class="mf">29.99999221284971</span><span class="p">,</span> <span class="mf">30.000007787150288</span><span class="p">],</span> <span class="p">[</span><span class="mf">17.4</span><span class="p">,</span> <span class="mf">29.999992883080424</span><span class="p">,</span> <span class="mf">30.000007116919573</span><span class="p">],</span> <span class="p">[</span><span class="mf">17.5</span><span class="p">,</span> <span class="mf">29.999993495625187</span><span class="p">,</span> <span class="mf">30.00000650437481</span><span class="p">],</span> <span class="p">[</span><span class="mf">17.6</span><span class="p">,</span> <span class="mf">29.999994055448955</span><span class="p">,</span> <span class="mf">30.00000594455104</span><span class="p">],</span> <span class="p">[</span><span class="mf">17.7</span><span class="p">,</span> <span class="mf">29.99999456708936</span><span class="p">,</span> <span class="mf">30.000005432910637</span><span class="p">],</span> <span class="p">[</span><span class="mf">17.8</span><span class="p">,</span> <span class="mf">29.99999503469349</span><span class="p">,</span> <span class="mf">30.000004965306506</span><span class="p">],</span> <span class="p">[</span><span class="mf">17.9</span><span class="p">,</span> <span class="mf">29.999995462051498</span><span class="p">,</span> <span class="mf">30.0000045379485</span><span class="p">],</span> <span class="p">[</span><span class="mf">18.0</span><span class="p">,</span> <span class="mf">29.99999585262731</span><span class="p">,</span> <span class="mf">30.000004147372685</span><span class="p">],</span> <span class="p">[</span><span class="mf">18.1</span><span class="p">,</span> <span class="mf">29.99999620958673</span><span class="p">,</span> <span class="mf">30.000003790413267</span><span class="p">],</span> <span class="p">[</span><span class="mf">18.200000000000003</span><span class="p">,</span> <span class="mf">29.99999653582308</span><span class="p">,</span> <span class="mf">30.000003464176917</span><span class="p">],</span> <span class="p">[</span><span class="mf">18.3</span><span class="p">,</span> <span class="mf">29.999996833980653</span><span class="p">,</span> <span class="mf">30.000003166019344</span><span class="p">],</span> <span class="p">[</span><span class="mf">18.4</span><span class="p">,</span> <span class="mf">29.99999710647616</span><span class="p">,</span> <span class="mf">30.000002893523835</span><span class="p">],</span> <span class="p">[</span><span class="mf">18.5</span><span class="p">,</span> <span class="mf">29.99999735551831</span><span class="p">,</span> <span class="mf">30.000002644481686</span><span class="p">],</span> <span class="p">[</span><span class="mf">18.6</span><span class="p">,</span> <span class="mf">29.999997583125694</span><span class="p">,</span> <span class="mf">30.000002416874302</span><span class="p">],</span> <span class="p">[</span><span class="mf">18.700000000000003</span><span class="p">,</span> <span class="mf">29.999997791143187</span><span class="p">,</span> <span class="mf">30.00000220885681</span><span class="p">],</span> <span class="p">[</span><span class="mf">18.8</span><span class="p">,</span> <span class="mf">29.99999798125686</span><span class="p">,</span> <span class="mf">30.000002018743135</span><span class="p">],</span> <span class="p">[</span><span class="mf">18.9</span><span class="p">,</span> <span class="mf">29.99999815500768</span><span class="p">,</span> <span class="mf">30.000001844992315</span><span class="p">],</span> <span class="p">[</span><span class="mf">19.0</span><span class="p">,</span> <span class="mf">29.999998313803975</span><span class="p">,</span> <span class="mf">30.000001686196022</span><span class="p">],</span> <span class="p">[</span><span class="mf">19.1</span><span class="p">,</span> <span class="mf">29.999998458932858</span><span class="p">,</span> <span class="mf">30.00000154106714</span><span class="p">],</span> <span class="p">[</span><span class="mf">19.200000000000003</span><span class="p">,</span> <span class="mf">29.999998591570673</span><span class="p">,</span> <span class="mf">30.000001408429323</span><span class="p">],</span> <span class="p">[</span><span class="mf">19.3</span><span class="p">,</span> <span class="mf">29.99999871279251</span><span class="p">,</span> <span class="mf">30.000001287207485</span><span class="p">],</span> <span class="p">[</span><span class="mf">19.4</span><span class="p">,</span> <span class="mf">29.999998823580924</span><span class="p">,</span> <span class="mf">30.000001176419072</span><span class="p">],</span> <span class="p">[</span><span class="mf">19.5</span><span class="p">,</span> <span class="mf">29.999998924833914</span><span class="p">,</span> <span class="mf">30.000001075166082</span><span class="p">],</span> <span class="p">[</span><span class="mf">19.6</span><span class="p">,</span> <span class="mf">29.999999017372176</span><span class="p">,</span> <span class="mf">30.00000098262782</span><span class="p">],</span> <span class="p">[</span><span class="mf">19.700000000000003</span><span class="p">,</span> <span class="mf">29.999999101945786</span><span class="p">,</span> <span class="mf">30.00000089805421</span><span class="p">],</span> <span class="p">[</span><span class="mf">19.8</span><span class="p">,</span> <span class="mf">29.99999917924024</span><span class="p">,</span> <span class="mf">30.000000820759755</span><span class="p">],</span> <span class="p">[</span><span class="mf">19.9</span><span class="p">,</span> <span class="mf">29.999999249882055</span><span class="p">,</span> <span class="mf">30.00000075011794</span><span class="p">],</span> <span class="p">[</span><span class="mf">20.0</span><span class="p">,</span> <span class="mf">29.999999314443816</span><span class="p">,</span> <span class="mf">30.00000068555618</span><span class="p">]]</span>
</pre></div>
</div>
<p>There are several types of <strong>Observer</strong>s for E-Cell4.
<strong>FixedIntervalNumberObserver</strong> is the simplest <strong>Observer</strong> to obtain the time-series result.
As its name suggests, this <strong>Observer</strong> records the number of molecules for each time-step.
The 1st argument is the time-step, the 2nd argument is the molecule types.
You can check the result with <strong>data</strong> method, but there is a shortcut for this</p>
<pre class="code highlight python literal-block">
<span class="n">viz</span><span class="o">.</span><span class="n">plot_number_observer</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
</pre>
<p><img alt="png" src="worldsim_24_0.png" /></p>
<p>This plots the time-series result easily.</p>
<p>We explained the internal of <strong>run_simulation</strong> function.
When you change the <strong>World</strong> after creating the <strong>Simulator</strong>, you need to indicate it to <strong>Simulator</strong>.
So do NOT forget to call</p>
<pre class="code highlight python literal-block">
<span class="n">sim</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
</pre>
</div>
<div class="section" id="switching-the-solver">
<span id="switching-the-solver"></span><h2>Switching the solver<a class="headerlink" href="#switching-the-solver" title="Permalink to this headline">¶</a></h2>
<p>It is NOT difficult to switch the solver to stochastic method, as we showed <strong>run_simulation</strong>.</p>
<pre class="code highlight python literal-block">
<span class="kn">from</span> <span class="nn">ecell4</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">with</span> <span class="n">reaction_rules</span><span class="p">():</span>
    <span class="n">A</span> <span class="o">+</span> <span class="n">B</span> <span class="o">==</span> <span class="n">C</span> <span class="o">|</span> <span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">get_model</span><span class="p">()</span>

<span class="c"># ode.ODEWorld -&gt; gillespie.GillespieWorld</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">gillespie</span><span class="o">.</span><span class="n">GillespieWorld</span><span class="p">(</span><span class="n">Real3</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">w</span><span class="o">.</span><span class="n">add_molecules</span><span class="p">(</span><span class="n">Species</span><span class="p">(</span><span class="s">'C'</span><span class="p">),</span> <span class="mi">60</span><span class="p">)</span>

<span class="c"># ode.ODESimulator -&gt; gillespie.GillespieSimulator</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">gillespie</span><span class="o">.</span><span class="n">GillespieSimulator</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">FixedIntervalNumberObserver</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="s">'A'</span><span class="p">,</span> <span class="s">'C'</span><span class="p">))</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">obs</span><span class="p">)</span>

<span class="n">viz</span><span class="o">.</span><span class="n">plot_number_observer</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
</pre>
<p><img alt="png" src="worldsim_28_0.png" /></p>
<p><strong>World</strong> and <strong>Simulator</strong> do NOT change the <strong>Model</strong>, so you can switch several simulators for 1 model.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Meso.html" class="btn btn-neutral float-right" title="Meso" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Introduction.html" class="btn btn-neutral" title="Introduction" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Test.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'test',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>